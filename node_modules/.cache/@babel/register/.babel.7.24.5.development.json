{"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\min\\\\Desktop\\\\webRTC-lab\\\\src\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\min\\\\Desktop\\\\webRTC-lab\",\"filename\":\"C:\\\\Users\\\\min\\\\Desktop\\\\webRTC-lab\\\\src\\\\server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\min\\\\Desktop\\\\webRTC-lab\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"transform-unicode-sets-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-class-static-block\",\"visitor\":{\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-private-property-in-object\",\"visitor\":{\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"transform-numeric-separator\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-logical-assignment-operators\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-nullish-coalescing-operator\",\"visitor\":{\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-chaining\",\"visitor\":{\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-json-strings\",\"visitor\":{\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-optional-catch-binding\",\"visitor\":{\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-generator-functions\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"DoWhileStatement\":{\"exit\":[null]},\"ForInStatement\":{\"exit\":[null]},\"ForStatement\":{\"exit\":[null]},\"WhileStatement\":{\"exit\":[null]},\"ForOfStatement\":{\"exit\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null,null]},\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"CallExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.5:development":{"value":{"code":"\"use strict\";\n\nvar _http = _interopRequireDefault(require(\"http\"));\nvar _socket = _interopRequireDefault(require(\"socket.io\"));\nvar _express = _interopRequireDefault(require(\"express\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nvar app = (0, _express[\"default\"])();\napp.set(\"view engine\", \"pug\");\napp.set(\"views\", __dirname + \"/views\");\napp.use(\"/public\", _express[\"default\"][\"static\"](__dirname + \"/public\"));\napp.get(\"/\", function (_, res) {\n  return res.render(\"home\");\n});\napp.get(\"/*\", function (_, res) {\n  return res.redirect(\"/\");\n});\nvar httpServer = _http[\"default\"].createServer(app);\nvar wsServer = (0, _socket[\"default\"])(httpServer);\nvar roomObjArr = [\n  // {\n  //   roomName,\n  //   currentNum,\n  //   users: [\n  //     {\n  //       socketId,\n  //       nickname,\n  //     },\n  //   ],\n  // },\n];\nvar MAXIMUM = 5;\nwsServer.on(\"connection\", function (socket) {\n  var myRoomName = null;\n  var myNickname = null;\n  socket.on(\"join_room\", function (roomName, nickname) {\n    myRoomName = roomName;\n    myNickname = nickname;\n    var isRoomExist = false;\n    var targetRoomObj = null;\n\n    // forEach를 사용하지 않는 이유: callback함수를 사용하기 때문에 return이 효용없음.\n    for (var i = 0; i < roomObjArr.length; ++i) {\n      if (roomObjArr[i].roomName === roomName) {\n        // Reject join the room\n        if (roomObjArr[i].currentNum >= MAXIMUM) {\n          socket.emit(\"reject_join\");\n          return;\n        }\n        isRoomExist = true;\n        targetRoomObj = roomObjArr[i];\n        break;\n      }\n    }\n\n    // Create room\n    if (!isRoomExist) {\n      targetRoomObj = {\n        roomName: roomName,\n        currentNum: 0,\n        users: []\n      };\n      roomObjArr.push(targetRoomObj);\n    }\n\n    //Join the room\n    targetRoomObj.users.push({\n      socketId: socket.id,\n      nickname: nickname\n    });\n    ++targetRoomObj.currentNum;\n    socket.join(roomName);\n    socket.emit(\"accept_join\", targetRoomObj.users);\n  });\n  socket.on(\"offer\", function (offer, remoteSocketId, localNickname) {\n    socket.to(remoteSocketId).emit(\"offer\", offer, socket.id, localNickname);\n  });\n  socket.on(\"answer\", function (answer, remoteSocketId) {\n    socket.to(remoteSocketId).emit(\"answer\", answer, socket.id);\n  });\n  socket.on(\"ice\", function (ice, remoteSocketId) {\n    socket.to(remoteSocketId).emit(\"ice\", ice, socket.id);\n  });\n  socket.on(\"chat\", function (message, roomName) {\n    socket.to(roomName).emit(\"chat\", message);\n  });\n  socket.on(\"disconnecting\", function () {\n    socket.to(myRoomName).emit(\"leave_room\", socket.id, myNickname);\n    var isRoomEmpty = false;\n    for (var i = 0; i < roomObjArr.length; ++i) {\n      if (roomObjArr[i].roomName === myRoomName) {\n        var newUsers = roomObjArr[i].users.filter(function (user) {\n          return user.socketId != socket.id;\n        });\n        roomObjArr[i].users = newUsers;\n        --roomObjArr[i].currentNum;\n        if (roomObjArr[i].currentNum == 0) {\n          isRoomEmpty = true;\n        }\n      }\n    }\n\n    // Delete room\n    if (isRoomEmpty) {\n      var newRoomObjArr = roomObjArr.filter(function (roomObj) {\n        return roomObj.currentNum != 0;\n      });\n      roomObjArr = newRoomObjArr;\n    }\n  });\n});\nvar handleListen = function handleListen() {\n  return console.log(\"Listening on http://localhost:3000\");\n};\nhttpServer.listen(3000, handleListen);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaHR0cCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX3NvY2tldCIsIl9leHByZXNzIiwib2JqIiwiX19lc01vZHVsZSIsImFwcCIsImV4cHJlc3MiLCJzZXQiLCJfX2Rpcm5hbWUiLCJ1c2UiLCJnZXQiLCJfIiwicmVzIiwicmVuZGVyIiwicmVkaXJlY3QiLCJodHRwU2VydmVyIiwiaHR0cCIsImNyZWF0ZVNlcnZlciIsIndzU2VydmVyIiwiU29ja2V0SU8iLCJyb29tT2JqQXJyIiwiTUFYSU1VTSIsIm9uIiwic29ja2V0IiwibXlSb29tTmFtZSIsIm15Tmlja25hbWUiLCJyb29tTmFtZSIsIm5pY2tuYW1lIiwiaXNSb29tRXhpc3QiLCJ0YXJnZXRSb29tT2JqIiwiaSIsImxlbmd0aCIsImN1cnJlbnROdW0iLCJlbWl0IiwidXNlcnMiLCJwdXNoIiwic29ja2V0SWQiLCJpZCIsImpvaW4iLCJvZmZlciIsInJlbW90ZVNvY2tldElkIiwibG9jYWxOaWNrbmFtZSIsInRvIiwiYW5zd2VyIiwiaWNlIiwibWVzc2FnZSIsImlzUm9vbUVtcHR5IiwibmV3VXNlcnMiLCJmaWx0ZXIiLCJ1c2VyIiwibmV3Um9vbU9iakFyciIsInJvb21PYmoiLCJoYW5kbGVMaXN0ZW4iLCJjb25zb2xlIiwibG9nIiwibGlzdGVuIl0sInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXG1pblxcRGVza3RvcFxcd2ViUlRDLWxhYlxcc3JjXFwiLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgaHR0cCBmcm9tIFwiaHR0cFwiO1xyXG5pbXBvcnQgU29ja2V0SU8gZnJvbSBcInNvY2tldC5pb1wiO1xyXG5pbXBvcnQgZXhwcmVzcyBmcm9tIFwiZXhwcmVzc1wiO1xyXG5cclxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xyXG5cclxuYXBwLnNldChcInZpZXcgZW5naW5lXCIsIFwicHVnXCIpO1xyXG5hcHAuc2V0KFwidmlld3NcIiwgX19kaXJuYW1lICsgXCIvdmlld3NcIik7XHJcbmFwcC51c2UoXCIvcHVibGljXCIsIGV4cHJlc3Muc3RhdGljKF9fZGlybmFtZSArIFwiL3B1YmxpY1wiKSk7XHJcbmFwcC5nZXQoXCIvXCIsIChfLCByZXMpID0+IHJlcy5yZW5kZXIoXCJob21lXCIpKTtcclxuYXBwLmdldChcIi8qXCIsIChfLCByZXMpID0+IHJlcy5yZWRpcmVjdChcIi9cIikpO1xyXG5cclxuY29uc3QgaHR0cFNlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKGFwcCk7XHJcbmNvbnN0IHdzU2VydmVyID0gU29ja2V0SU8oaHR0cFNlcnZlcik7XHJcblxyXG5sZXQgcm9vbU9iakFyciA9IFtcclxuICAgIC8vIHtcclxuICAgIC8vICAgcm9vbU5hbWUsXHJcbiAgICAvLyAgIGN1cnJlbnROdW0sXHJcbiAgICAvLyAgIHVzZXJzOiBbXHJcbiAgICAvLyAgICAge1xyXG4gICAgLy8gICAgICAgc29ja2V0SWQsXHJcbiAgICAvLyAgICAgICBuaWNrbmFtZSxcclxuICAgIC8vICAgICB9LFxyXG4gICAgLy8gICBdLFxyXG4gICAgLy8gfSxcclxuXTtcclxuY29uc3QgTUFYSU1VTSA9IDU7XHJcblxyXG5cclxud3NTZXJ2ZXIub24oXCJjb25uZWN0aW9uXCIsIChzb2NrZXQpID0+IHtcclxuICAgIGxldCBteVJvb21OYW1lID0gbnVsbDtcclxuICAgIGxldCBteU5pY2tuYW1lID0gbnVsbDtcclxuXHJcbiAgICBzb2NrZXQub24oXCJqb2luX3Jvb21cIiwgKHJvb21OYW1lLCBuaWNrbmFtZSkgPT4ge1xyXG4gICAgICAgIG15Um9vbU5hbWUgPSByb29tTmFtZTtcclxuICAgICAgICBteU5pY2tuYW1lID0gbmlja25hbWU7XHJcblxyXG4gICAgICAgIGxldCBpc1Jvb21FeGlzdCA9IGZhbHNlO1xyXG4gICAgICAgIGxldCB0YXJnZXRSb29tT2JqID0gbnVsbDtcclxuXHJcbiAgICAgICAgLy8gZm9yRWFjaOulvCDsgqzsmqntlZjsp4Ag7JWK64qUIOydtOycoDogY2FsbGJhY2vtlajsiJjrpbwg7IKs7Jqp7ZWY6riwIOuVjOusuOyXkCByZXR1cm7snbQg7Zqo7Jqp7JeG7J2MLlxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcm9vbU9iakFyci5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICBpZiAocm9vbU9iakFycltpXS5yb29tTmFtZSA9PT0gcm9vbU5hbWUpIHtcclxuICAgICAgICAgICAgICAgIC8vIFJlamVjdCBqb2luIHRoZSByb29tXHJcbiAgICAgICAgICAgICAgICBpZiAocm9vbU9iakFycltpXS5jdXJyZW50TnVtID49IE1BWElNVU0pIHtcclxuICAgICAgICAgICAgICAgICAgICBzb2NrZXQuZW1pdChcInJlamVjdF9qb2luXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpc1Jvb21FeGlzdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXRSb29tT2JqID0gcm9vbU9iakFycltpXTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDcmVhdGUgcm9vbVxyXG4gICAgICAgIGlmICghaXNSb29tRXhpc3QpIHtcclxuICAgICAgICAgICAgdGFyZ2V0Um9vbU9iaiA9IHtcclxuICAgICAgICAgICAgICAgIHJvb21OYW1lLFxyXG4gICAgICAgICAgICAgICAgY3VycmVudE51bTogMCxcclxuICAgICAgICAgICAgICAgIHVzZXJzOiBbXSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcm9vbU9iakFyci5wdXNoKHRhcmdldFJvb21PYmopO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy9Kb2luIHRoZSByb29tXHJcbiAgICAgICAgdGFyZ2V0Um9vbU9iai51c2Vycy5wdXNoKHtcclxuICAgICAgICAgICAgc29ja2V0SWQ6IHNvY2tldC5pZCxcclxuICAgICAgICAgICAgbmlja25hbWUsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgKyt0YXJnZXRSb29tT2JqLmN1cnJlbnROdW07XHJcblxyXG4gICAgICAgIHNvY2tldC5qb2luKHJvb21OYW1lKTtcclxuICAgICAgICBzb2NrZXQuZW1pdChcImFjY2VwdF9qb2luXCIsIHRhcmdldFJvb21PYmoudXNlcnMpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgc29ja2V0Lm9uKFwib2ZmZXJcIiwgKG9mZmVyLCByZW1vdGVTb2NrZXRJZCwgbG9jYWxOaWNrbmFtZSkgPT4ge1xyXG4gICAgICAgIHNvY2tldC50byhyZW1vdGVTb2NrZXRJZCkuZW1pdChcIm9mZmVyXCIsIG9mZmVyLCBzb2NrZXQuaWQsIGxvY2FsTmlja25hbWUpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgc29ja2V0Lm9uKFwiYW5zd2VyXCIsIChhbnN3ZXIsIHJlbW90ZVNvY2tldElkKSA9PiB7XHJcbiAgICAgICAgc29ja2V0LnRvKHJlbW90ZVNvY2tldElkKS5lbWl0KFwiYW5zd2VyXCIsIGFuc3dlciwgc29ja2V0LmlkKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHNvY2tldC5vbihcImljZVwiLCAoaWNlLCByZW1vdGVTb2NrZXRJZCkgPT4ge1xyXG4gICAgICAgIHNvY2tldC50byhyZW1vdGVTb2NrZXRJZCkuZW1pdChcImljZVwiLCBpY2UsIHNvY2tldC5pZCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzb2NrZXQub24oXCJjaGF0XCIsIChtZXNzYWdlLCByb29tTmFtZSkgPT4ge1xyXG4gICAgICAgIHNvY2tldC50byhyb29tTmFtZSkuZW1pdChcImNoYXRcIiwgbWVzc2FnZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzb2NrZXQub24oXCJkaXNjb25uZWN0aW5nXCIsICgpID0+IHtcclxuICAgICAgICBzb2NrZXQudG8obXlSb29tTmFtZSkuZW1pdChcImxlYXZlX3Jvb21cIiwgc29ja2V0LmlkLCBteU5pY2tuYW1lKTtcclxuXHJcbiAgICAgICAgbGV0IGlzUm9vbUVtcHR5ID0gZmFsc2U7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb29tT2JqQXJyLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIGlmIChyb29tT2JqQXJyW2ldLnJvb21OYW1lID09PSBteVJvb21OYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdVc2VycyA9IHJvb21PYmpBcnJbaV0udXNlcnMuZmlsdGVyKFxyXG4gICAgICAgICAgICAgICAgICAgICh1c2VyKSA9PiB1c2VyLnNvY2tldElkICE9IHNvY2tldC5pZFxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIHJvb21PYmpBcnJbaV0udXNlcnMgPSBuZXdVc2VycztcclxuICAgICAgICAgICAgICAgIC0tcm9vbU9iakFycltpXS5jdXJyZW50TnVtO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChyb29tT2JqQXJyW2ldLmN1cnJlbnROdW0gPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlzUm9vbUVtcHR5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gRGVsZXRlIHJvb21cclxuICAgICAgICBpZiAoaXNSb29tRW1wdHkpIHtcclxuICAgICAgICAgICAgY29uc3QgbmV3Um9vbU9iakFyciA9IHJvb21PYmpBcnIuZmlsdGVyKFxyXG4gICAgICAgICAgICAgICAgKHJvb21PYmopID0+IHJvb21PYmouY3VycmVudE51bSAhPSAwXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIHJvb21PYmpBcnIgPSBuZXdSb29tT2JqQXJyO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59KTtcclxuXHJcbmNvbnN0IGhhbmRsZUxpc3RlbiA9ICgpID0+IGNvbnNvbGUubG9nKGBMaXN0ZW5pbmcgb24gaHR0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","map":{"version":3,"names":["_http","_interopRequireDefault","require","_socket","_express","obj","__esModule","app","express","set","__dirname","use","get","_","res","render","redirect","httpServer","http","createServer","wsServer","SocketIO","roomObjArr","MAXIMUM","on","socket","myRoomName","myNickname","roomName","nickname","isRoomExist","targetRoomObj","i","length","currentNum","emit","users","push","socketId","id","join","offer","remoteSocketId","localNickname","to","answer","ice","message","isRoomEmpty","newUsers","filter","user","newRoomObjArr","roomObj","handleListen","console","log","listen"],"sourceRoot":"C:\\Users\\min\\Desktop\\webRTC-lab\\src\\","sources":["server.js"],"sourcesContent":["import http from \"http\";\r\nimport SocketIO from \"socket.io\";\r\nimport express from \"express\";\r\n\r\nconst app = express();\r\n\r\napp.set(\"view engine\", \"pug\");\r\napp.set(\"views\", __dirname + \"/views\");\r\napp.use(\"/public\", express.static(__dirname + \"/public\"));\r\napp.get(\"/\", (_, res) => res.render(\"home\"));\r\napp.get(\"/*\", (_, res) => res.redirect(\"/\"));\r\n\r\nconst httpServer = http.createServer(app);\r\nconst wsServer = SocketIO(httpServer);\r\n\r\nlet roomObjArr = [\r\n    // {\r\n    //   roomName,\r\n    //   currentNum,\r\n    //   users: [\r\n    //     {\r\n    //       socketId,\r\n    //       nickname,\r\n    //     },\r\n    //   ],\r\n    // },\r\n];\r\nconst MAXIMUM = 5;\r\n\r\n\r\nwsServer.on(\"connection\", (socket) => {\r\n    let myRoomName = null;\r\n    let myNickname = null;\r\n\r\n    socket.on(\"join_room\", (roomName, nickname) => {\r\n        myRoomName = roomName;\r\n        myNickname = nickname;\r\n\r\n        let isRoomExist = false;\r\n        let targetRoomObj = null;\r\n\r\n        // forEach를 사용하지 않는 이유: callback함수를 사용하기 때문에 return이 효용없음.\r\n        for (let i = 0; i < roomObjArr.length; ++i) {\r\n            if (roomObjArr[i].roomName === roomName) {\r\n                // Reject join the room\r\n                if (roomObjArr[i].currentNum >= MAXIMUM) {\r\n                    socket.emit(\"reject_join\");\r\n                    return;\r\n                }\r\n\r\n                isRoomExist = true;\r\n                targetRoomObj = roomObjArr[i];\r\n                break;\r\n            }\r\n        }\r\n\r\n        // Create room\r\n        if (!isRoomExist) {\r\n            targetRoomObj = {\r\n                roomName,\r\n                currentNum: 0,\r\n                users: [],\r\n            };\r\n            roomObjArr.push(targetRoomObj);\r\n        }\r\n\r\n        //Join the room\r\n        targetRoomObj.users.push({\r\n            socketId: socket.id,\r\n            nickname,\r\n        });\r\n        ++targetRoomObj.currentNum;\r\n\r\n        socket.join(roomName);\r\n        socket.emit(\"accept_join\", targetRoomObj.users);\r\n    });\r\n\r\n    socket.on(\"offer\", (offer, remoteSocketId, localNickname) => {\r\n        socket.to(remoteSocketId).emit(\"offer\", offer, socket.id, localNickname);\r\n    });\r\n\r\n    socket.on(\"answer\", (answer, remoteSocketId) => {\r\n        socket.to(remoteSocketId).emit(\"answer\", answer, socket.id);\r\n    });\r\n\r\n    socket.on(\"ice\", (ice, remoteSocketId) => {\r\n        socket.to(remoteSocketId).emit(\"ice\", ice, socket.id);\r\n    });\r\n\r\n    socket.on(\"chat\", (message, roomName) => {\r\n        socket.to(roomName).emit(\"chat\", message);\r\n    });\r\n\r\n    socket.on(\"disconnecting\", () => {\r\n        socket.to(myRoomName).emit(\"leave_room\", socket.id, myNickname);\r\n\r\n        let isRoomEmpty = false;\r\n        for (let i = 0; i < roomObjArr.length; ++i) {\r\n            if (roomObjArr[i].roomName === myRoomName) {\r\n                const newUsers = roomObjArr[i].users.filter(\r\n                    (user) => user.socketId != socket.id\r\n                );\r\n                roomObjArr[i].users = newUsers;\r\n                --roomObjArr[i].currentNum;\r\n\r\n                if (roomObjArr[i].currentNum == 0) {\r\n                    isRoomEmpty = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Delete room\r\n        if (isRoomEmpty) {\r\n            const newRoomObjArr = roomObjArr.filter(\r\n                (roomObj) => roomObj.currentNum != 0\r\n            );\r\n            roomObjArr = newRoomObjArr;\r\n        }\r\n    });\r\n});\r\n\r\nconst handleListen = () => console.log(`Listening on http://localhost:3000`);\r\nhttpServer.listen(3000, handleListen);"],"mappings":"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","ignoreList":[]}},"mtime":1714896264646}}